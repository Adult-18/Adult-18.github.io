{{ define "main" }}
  {{ if or (isset .Params "image") (isset .Params "linkVideo") }}
    <div class="d-g gg-20 gtc-m">
      <div class="sticky">
        {{- partial "main.html" . -}}
      </div>
      <div class="sticky">
        {{- partial "sidebar.html" . -}}
      </div>
    </div>
  {{ else }}
    <div class="d-g gg-5">{{- .Content -}}</div>
  {{ end }}

  {{/* HTML untuk Pop-up Link dengan Gambar Shopee */}}
  <div id="timed-popup-overlay" style="
      display: none; /* Sembunyikan secara default */
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7); /* Latar belakang semi-transparan */
      z-index: 9998; /* Pastikan di atas konten lain */
      justify-content: center; /* Pusatkan secara horizontal */
      align-items: center; /* Pusatkan secara vertikal */
      padding: 15px; /* Tambahkan padding di overlay agar pop-up tidak terlalu mepet ke tepi layar */
      box-sizing: border-box; /* Penting untuk padding */
      ">
    <div id="timed-popup-content" style="
        background-color: #15202b91; /* Warna latar belakang gelap */
        padding: 20px; /* Tingkatkan padding di dalam pop-up untuk mobile */
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        text-align: center;
        max-width: 450px; /* Lebar maksimum di desktop */
        width: 100%; /* Pastikan mengisi 100% dari ruang yang tersedia setelah padding overlay */
        box-sizing: border-box; /* Penting untuk padding */
        position: relative;
        z-index: 9999;
        ">
      {{/* Gambar di dalam Pop-up - Asumsi ini adalah logo/banner Shopee yang dimaksud */}}
      <img src="/img/affiliate.jpg" alt="Shopee - Belanja Dulu" style="
          max-width: 100%;
          height: auto;
          margin-bottom: 15px; /* Sedikit jarak antara gambar dan tombol */
          border-radius: 5px;
          ">

      <a href="https://s.shopee.co.id/LeEVWCybD" target="_blank" id="popup-action-link" style="
          display: inline-block;
          padding: 12px 20px; /* Sedikit sesuaikan padding tombol */
          background-color: #ee4d2d; /* Warna oranye Shopee */
          color: white;
          border-radius: 5px;
          text-decoration: none;
          font-weight: bold;
          font-size: 1.2em; /* Sedikit lebih besar untuk keterbacaan di mobile */
          transition: background-color 0.3s ease;
        " onmouseover="this.style.backgroundColor='#d33b21'" onmouseout="this.style.backgroundColor='#ee4d2d'">
        Belanja dulu di Shopee baru NONTON
      </a>
      {{/* Catatan bahwa pop-up tidak akan hilang sebelum klik dan akan muncul lagi */}}
      <p style="margin-top: 15px; font-size: 0.9em; color: #ff3939;">(Pop-up ini tidak akan hilang kecuali Anda mengklik link. Akan muncul lagi setiap 2 menit.)</p>
    </div>
  </div>

  {{/* JavaScript untuk logika Pop-up */}}
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const popupOverlay = document.getElementById('timed-popup-overlay');
      const popupActionLink = document.getElementById('popup-action-link');
      const initialDelay = 10 * 1000; // 10 detik dalam milidetik
      const recurringInterval = 2 * 60 * 1000; // 2 menit dalam milidetik

      let popupTimer; // Variabel untuk menyimpan ID interval

      function showPopup() {
        if (popupOverlay) {
          popupOverlay.style.display = 'flex'; // Tampilkan overlay dengan flex untuk centering
        }
      }

      function startRecurringPopup() {
        // Hapus timer yang ada untuk mencegah duplikasi jika fungsi ini dipanggil lebih dari sekali
        if (popupTimer) {
          clearInterval(popupTimer);
        }
        // Mulai interval yang akan menampilkan pop-up setiap 2 menit
        popupTimer = setInterval(showPopup, recurringInterval);
      }

      // Tampilkan pop-up pertama kali setelah initialDelay (10 detik)
      setTimeout(function() {
        showPopup(); // Panggil fungsi untuk menampilkan pop-up
        startRecurringPopup(); // Setelah pop-up pertama muncul, mulai timer untuk kemunculan berulang
      }, initialDelay);


      // Event listener untuk menyembunyikan pop-up saat link diklik
      if (popupActionLink) {
        popupActionLink.addEventListener('click', function(e) {
          // e.preventDefault(); // Jangan preventDefault jika Anda ingin link benar-benar navigasi
          if (popupOverlay) {
            popupOverlay.style.display = 'none'; // Sembunyikan pop-up
            // Interval berulang akan terus berjalan di latar belakang,
            // sehingga pop-up akan muncul lagi setelah 2 menit dari jadwalnya.
          }
        });
      }
    });
  </script>
{{ end }}